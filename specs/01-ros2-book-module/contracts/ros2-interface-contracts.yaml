# ROS 2 Interface Contracts: Module 1: The Robotic Nervous System (ROS 2)

**Date**: 2025-12-16
**Feature**: 01-ros2-book-module
**Contract Type**: Educational Interface Definitions

## Overview

This document defines the conceptual interfaces and contracts that students will learn to implement in ROS 2. These represent the patterns and communication protocols that will be taught in the module.

## Message Type Definitions

### Sensor Data Messages

```yaml
# JointState.msg
# Used for communicating joint position, velocity, and effort data
float64[] position
float64[] velocity
float64[] effort
string[] name
```

```yaml
# Imu.msg
# Used for communicating Inertial Measurement Unit data
Header header
geometry_msgs/Quaternion orientation
float64[9] orientation_covariance
geometry_msgs/Vector3 angular_velocity
float64[9] angular_velocity_covariance
geometry_msgs/Vector3 linear_acceleration
float64[9] linear_acceleration_covariance
```

```yaml
# Image.msg
# Used for communicating camera image data
Header header
string encoding
uint8 is_bigendian
uint32 step
uint8[] data
```

### Control Command Messages

```yaml
# Twist.msg
# Used for velocity commands (linear and angular)
geometry_msgs/Vector3 linear
geometry_msgs/Vector3 angular
```

```yaml
# JointTrajectory.msg
# Used for trajectory commands to joint controllers
Header header
JointTrajectoryPoint[] points
string[] joint_names
```

## Service Definitions

### Robot Control Services

```yaml
# SetPosition.srv
# Request to set a joint to a specific position
float64 position
---
# Response
bool success
string message
```

```yaml
# GetRobotState.srv
# Request current robot state
---
# Response
JointState joint_state
Imu imu_data
bool success
string message
```

## Action Definitions

### Complex Robot Actions

```yaml
# MoveToGoal.action
# Action for moving robot to a specific goal
geometry_msgs/PoseStamped goal
---
# Result
bool success
string message
---
# Feedback
float64 distance_remaining
string status
```

## Topic Interfaces

### Sensor Data Topics

```yaml
# Joint state topic
Topic: /joint_states
Type: sensor_msgs/JointState
QoS: Reliable, Durability: Volatile
Purpose: Publish joint position, velocity, and effort data
```

```yaml
# IMU data topic
Topic: /imu/data
Type: sensor_msgs/Imu
QoS: Best Effort, Durability: Volatile
Purpose: Publish inertial measurement data
```

```yaml
# Camera image topic
Topic: /camera/image_raw
Type: sensor_msgs/Image
QoS: Best Effort, Durability: Volatile
Purpose: Publish raw camera image data
```

### Control Command Topics

```yaml
# Velocity command topic
Topic: /cmd_vel
Type: geometry_msgs/Twist
QoS: Reliable, Durability: Transient_Local
Purpose: Send velocity commands to robot base
```

```yaml
# Joint trajectory command topic
Topic: /joint_trajectory_controller/joint_trajectory
Type: trajectory_msgs/JointTrajectory
QoS: Reliable, Durability: Volatile
Purpose: Send joint trajectory commands to controllers
```

## Service Interfaces

### Robot State Services

```yaml
# Get robot configuration
Service: /get_robot_config
Type: custom_interfaces/GetRobotConfig
Purpose: Retrieve current robot configuration parameters
```

```yaml
# Set robot mode
Service: /set_robot_mode
Type: custom_interfaces/SetRobotMode
Purpose: Change operational mode of the robot
```

## Quality of Service (QoS) Patterns

### Real-time Critical Data
- **Reliability**: Reliable
- **Durability**: Volatile
- **History**: Keep Last
- **Depth**: 1
- **Use Case**: Joint trajectory commands, safety-critical data

### Sensor Data
- **Reliability**: Best Effort (when possible)
- **Durability**: Volatile
- **History**: Keep Last
- **Depth**: 10
- **Use Case**: Camera images, LIDAR data

### Configuration Data
- **Reliability**: Reliable
- **Durability**: Transient_Local
- **History**: Keep All
- **Depth**: Unlimited
- **Use Case**: Robot parameters, configuration updates

## Node Interface Patterns

### Sensor Node Interface
```
Publishes:
- /sensor_data (sensor_msgs/Imu, sensor_msgs/Image, etc.)
- /diagnostics (diagnostic_msgs/DiagnosticArray)

Subscribes:
- /sensor_config (custom_msgs/SensorConfig) - optional
```

### Controller Node Interface
```
Publishes:
- /joint_states (sensor_msgs/JointState)
- /tf (tf2_msgs/TFMessage)

Subscribes:
- /cmd_vel (geometry_msgs/Twist)
- /joint_trajectory (trajectory_msgs/JointTrajectory)
```

### AI Agent Node Interface
```
Publishes:
- /navigation/goal (geometry_msgs/PoseStamped)
- /robot_command (custom_msgs/RobotCommand)

Subscribes:
- /sensor_data (various sensor types)
- /robot_state (custom_msgs/RobotState)
```

## Validation Criteria

### Message Validation
- All messages must conform to ROS 2 message specification
- Field types must match expected types
- Array bounds must be validated where appropriate
- Units must be consistent and documented

### Topic Validation
- Topic names must follow ROS 2 naming conventions
- Message types must be correctly specified
- QoS settings must match data requirements
- Publisher/subscriber counts must be reasonable

### Service Validation
- Request/response patterns must be clearly defined
- Error handling must be specified
- Timeout values must be appropriate
- Authentication requirements must be documented

## Module Integration Points

### With Module 2 (Gazebo Simulation)
- URDF definitions must match simulation models
- Topic names must align with Gazebo ROS plugins
- Message types must be compatible with simulation

### With Module 3 (Isaac Sim & Isaac ROS)
- Interface patterns should support hardware acceleration
- Message formats should align with Isaac ROS standards
- Performance requirements should consider GPU processing

## Educational Learning Objectives

By understanding these interfaces, students will be able to:
1. Create ROS 2 nodes that properly interface with other components
2. Design appropriate message types for their applications
3. Configure QoS settings based on data requirements
4. Implement services and actions for complex interactions
5. Prepare for integration with simulation and real hardware